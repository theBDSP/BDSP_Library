#pragma once

namespace bdsp
{
	namespace dsp
	{
		namespace DistortionTypes
		{

			static const juce::Array<double> HardClipCompensationData = { 0.569224,0.611475,0.650155,0.684424,0.711663,0.735119,0.757363,0.775249,0.790775,0.806602,0.820822,0.830806,0.839738,0.847605,0.854292,0.862952,0.870481,0.873844,0.880461,0.88493,0.889822,0.89466,0.897148,0.900489,0.905771,0.907716,0.910928,0.913512,0.913285,0.917087,0.919541,0.920795,0.923112,0.924766,0.926966,0.928114,0.928524,0.930638,0.930447,0.932119,0.93666,0.936879,0.936522,0.93605,0.937202,0.939101,0.939108,0.940757,0.940126,0.941278,0.941608,0.943559,0.944364,0.943916,0.946984,0.944476,0.944851,0.946991,0.947956,0.947656,0.948481,0.947653,0.948359,0.950136,0.948787,0.948949,0.949496,0.949444,0.952046,0.952773,0.951232,0.952563,0.953427,0.95343,0.953445,0.953764,0.954222,0.9535,0.954877,0.952867,0.955019,0.95612,0.955883,0.955214,0.955548,0.956128,0.954899,0.95681,0.956632,0.957282,0.957327,0.955603,0.957038,0.956542,0.957571,0.957333,0.958014,0.957971,0.958426,0.957808,0.95836 };
			static const unsigned char HardClipPathData[] = { 110,109,0,0,128,191,0,0,128,63,108,164,112,125,191,0,0,128,63,108,72,225,122,191,0,0,128,63,108,236,81,120,191,0,0,128,63,108,144,194,117,191,0,0,128,63,108,52,51,115,191,0,0,128,63,108,216,163,112,191,0,0,128,63,108,124,20,110,191,0,0,128,63,108,32, 133,107,191,0,0,128,63,108,196,245,104,191,0,0,128,63,108,104,102,102,191,0,0,128,63,108,12,215,99,191,0,0,128,63,108,176,71,97,191,0,0,128,63,108,84,184,94,191,0,0,128,63,108,248,40,92,191,0,0,128,63,108,156,153,89,191,0,0,128,63,108,64,10,87,191,0, 0,128,63,108,228,122,84,191,0,0,128,63,108,136,235,81,191,0,0,128,63,108,44,92,79,191,0,0,128,63,108,208,204,76,191,0,0,128,63,108,116,61,74,191,0,0,128,63,108,24,174,71,191,0,0,128,63,108,188,30,69,191,0,0,128,63,108,96,143,66,191,0,0,128,63,108,4,0, 64,191,0,0,128,63,108,168,112,61,191,0,0,128,63,108,76,225,58,191,0,0,128,63,108,240,81,56,191,0,0,128,63,108,148,194,53,191,0,0,128,63,108,56,51,51,191,0,0,128,63,108,220,163,48,191,0,0,128,63,108,128,20,46,191,0,0,128,63,108,36,133,43,191,0,0,128,63, 108,200,245,40,191,0,0,128,63,108,108,102,38,191,0,0,128,63,108,16,215,35,191,0,0,128,63,108,180,71,33,191,0,0,128,63,108,88,184,30,191,0,0,128,63,108,252,40,28,191,0,0,128,63,108,160,153,25,191,0,0,128,63,108,68,10,23,191,0,0,128,63,108,232,122,20,191, 0,0,128,63,108,140,235,17,191,0,0,128,63,108,48,92,15,191,0,0,128,63,108,212,204,12,191,0,0,128,63,108,120,61,10,191,0,0,128,63,108,28,174,7,191,0,0,128,63,108,192,30,5,191,0,0,128,63,108,100,143,2,191,0,0,128,63,108,8,0,0,191,0,0,128,63,108,88,225,250, 190,0,0,128,63,108,160,194,245,190,0,0,128,63,108,232,163,240,190,0,0,128,63,108,48,133,235,190,0,0,128,63,108,120,102,230,190,0,0,128,63,108,192,71,225,190,0,0,128,63,108,8,41,220,190,0,0,128,63,108,80,10,215,190,0,0,128,63,108,152,235,209,190,0,0,128, 63,108,224,204,204,190,0,0,128,63,108,40,174,199,190,0,0,128,63,108,112,143,194,190,0,0,128,63,108,184,112,189,190,0,0,128,63,108,0,82,184,190,0,0,128,63,108,72,51,179,190,0,0,128,63,108,144,20,174,190,0,0,128,63,108,216,245,168,190,0,0,128,63,108,32, 215,163,190,0,0,128,63,108,104,184,158,190,0,0,128,63,108,176,153,153,190,0,0,128,63,108,248,122,148,190,0,0,128,63,108,64,92,143,190,0,0,128,63,108,136,61,138,190,0,0,128,63,108,208,30,133,190,0,0,128,63,108,24,0,128,190,0,0,128,63,108,191,194,117,190, 0,0,128,63,108,78,133,107,190,0,0,128,63,108,221,71,97,190,0,0,128,63,108,108,10,87,190,254,75,119,63,108,251,204,76,190,85,133,107,63,108,138,143,66,190,173,190,95,63,108,25,82,56,190,4,248,83,63,108,168,20,46,190,92,49,72,63,108,55,215,35,190,179,106, 60,63,108,198,153,25,190,11,164,48,63,108,85,92,15,190,99,221,36,63,108,228,30,5,190,186,22,25,63,108,231,194,245,189,18,80,13,63,108,6,72,225,189,107,137,1,63,108,37,205,204,189,133,133,235,62,108,68,82,184,189,54,248,211,62,108,99,215,163,189,230,106, 188,62,108,130,92,143,189,150,221,164,62,108,65,195,117,189,70,80,141,62,108,126,205,76,189,236,133,107,62,108,187,215,35,189,75,107,60,62,108,241,195,245,188,171,80,13,62,108,108,216,163,188,23,108,188,61,108,206,217,35,188,174,109,60,61,108,164,240, 48,181,36,123,75,54,108,70,212,35,60,82,103,60,189,108,168,213,163,60,233,104,188,189,108,45,193,245,60,20,79,13,190,108,89,214,35,61,180,105,60,190,108,28,204,76,61,85,132,107,190,108,223,193,117,61,123,79,141,190,108,209,91,143,61,203,220,164,190,108, 178,214,163,61,27,106,188,190,108,147,81,184,61,106,247,211,190,108,116,204,204,61,186,132,235,190,108,85,71,225,61,5,137,1,191,108,54,194,245,61,173,79,13,191,108,140,30,5,62,85,22,25,191,108,253,91,15,62,253,220,36,191,108,110,153,25,62,166,163,48, 191,108,223,214,35,62,78,106,60,191,108,80,20,46,62,247,48,72,191,108,193,81,56,62,159,247,83,191,108,50,143,66,62,72,190,95,191,108,163,204,76,62,240,132,107,191,108,20,10,87,62,152,75,119,191,108,133,71,97,62,0,0,128,191,108,246,132,107,62,0,0,128, 191,108,103,194,117,62,0,0,128,191,108,216,255,127,62,0,0,128,191,108,164,30,133,62,0,0,128,191,108,92,61,138,62,0,0,128,191,108,20,92,143,62,0,0,128,191,108,204,122,148,62,0,0,128,191,108,132,153,153,62,0,0,128,191,108,60,184,158,62,0,0,128,191,108, 244,214,163,62,0,0,128,191,108,172,245,168,62,0,0,128,191,108,100,20,174,62,0,0,128,191,108,28,51,179,62,0,0,128,191,108,212,81,184,62,0,0,128,191,108,140,112,189,62,0,0,128,191,108,68,143,194,62,0,0,128,191,108,252,173,199,62,0,0,128,191,108,180,204, 204,62,0,0,128,191,108,108,235,209,62,0,0,128,191,108,36,10,215,62,0,0,128,191,108,220,40,220,62,0,0,128,191,108,148,71,225,62,0,0,128,191,108,76,102,230,62,0,0,128,191,108,4,133,235,62,0,0,128,191,108,188,163,240,62,0,0,128,191,108,116,194,245,62,0, 0,128,191,108,44,225,250,62,0,0,128,191,108,228,255,255,62,0,0,128,191,108,78,143,2,63,0,0,128,191,108,170,30,5,63,0,0,128,191,108,6,174,7,63,0,0,128,191,108,98,61,10,63,0,0,128,191,108,190,204,12,63,0,0,128,191,108,26,92,15,63,0,0,128,191,108,118,235, 17,63,0,0,128,191,108,210,122,20,63,0,0,128,191,108,46,10,23,63,0,0,128,191,108,138,153,25,63,0,0,128,191,108,230,40,28,63,0,0,128,191,108,66,184,30,63,0,0,128,191,108,158,71,33,63,0,0,128,191,108,250,214,35,63,0,0,128,191,108,86,102,38,63,0,0,128,191, 108,178,245,40,63,0,0,128,191,108,14,133,43,63,0,0,128,191,108,106,20,46,63,0,0,128,191,108,198,163,48,63,0,0,128,191,108,34,51,51,63,0,0,128,191,108,126,194,53,63,0,0,128,191,108,218,81,56,63,0,0,128,191,108,54,225,58,63,0,0,128,191,108,146,112,61,63, 0,0,128,191,108,238,255,63,63,0,0,128,191,108,74,143,66,63,0,0,128,191,108,166,30,69,63,0,0,128,191,108,2,174,71,63,0,0,128,191,108,94,61,74,63,0,0,128,191,108,186,204,76,63,0,0,128,191,108,22,92,79,63,0,0,128,191,108,114,235,81,63,0,0,128,191,108,206, 122,84,63,0,0,128,191,108,42,10,87,63,0,0,128,191,108,134,153,89,63,0,0,128,191,108,226,40,92,63,0,0,128,191,108,62,184,94,63,0,0,128,191,108,154,71,97,63,0,0,128,191,108,246,214,99,63,0,0,128,191,108,82,102,102,63,0,0,128,191,108,174,245,104,63,0,0, 128,191,108,10,133,107,63,0,0,128,191,108,102,20,110,63,0,0,128,191,108,194,163,112,63,0,0,128,191,108,30,51,115,63,0,0,128,191,108,122,194,117,63,0,0,128,191,108,214,81,120,63,0,0,128,191,108,50,225,122,63,0,0,128,191,108,142,112,125,63,0,0,128,191, 108,234,255,127,63,0,0,128,191,101,0,0 };
			/**
			 * Standard clipping distortion. Distortion amount reduces clipping threshold.
			 * https://www.desmos.com/calculator/2atbk6cgo6
			 */
			template<typename T>
			struct HardClip : public DistortionTypeBase<T>
			{
				HardClip()
					:DistortionTypeBase<T>(HardClipCompensationData, HardClipPathData, sizeof(HardClipPathData))
				{
				}
				T processSample(T in, T amt, bool isScaled) override
				{
					T a = 9 * amt + 1;
					return signum(in) * juce::jmin(abs(a * in), 1.0f) * (isScaled ? DistortionTypeBase<T>::CompensationGain.processSample(amt) : 1);
				}

				inline static const juce::String Name{ "Hard Clip" };
			};

		}

	} //namespace dsp
} //namespace bdsp
